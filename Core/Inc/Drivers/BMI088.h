#pragma once
#include <stdbool.h>

// Register ADDRESSES
#define BMI088_ACC_SOFTRESET_REG 0x7E
#define BMI088_ACC_PWR_CONF_REG 0x7C
#define BMI088_ACC_PWR_CTRL 0x7D
#define BMI088_GYRO_PWR_REG 0x11
#define BMI088_GYR_SOFTRESET_REG 0x14
#define BMI088_FIFO_MODE_REG 0x48
#define BMI088_ACC_CONF_REG 0x40
#define BMI088_ACC_RANGE_REG 0x41
#define BMI088_GYRO_BANDWIDTH_REG 0x10
#define BMI088_GYRO_RANGE_REG 0x0F
#define BMI088_GYRO_INT_CTRL_REG 0x15
#define BMI088_GYRO_INT3_INT4_IO_CONF_REG 0x16
#define BMI088_GYRO_INT3_INT4_IO_MAP_REG 0x18
#define BMI088_ACC_INT1_IO_CONF_REG 0x53
#define BMI088_ACC_INT2_IO_CONF_REG 0x54
#define BMI088_ACC_INT1_INT2_MAP_DATA 0x58
#define BMI088_ACC_DATA_REG 0x12
#define BMI088_GYRO_DATA_REG 0x02

// reg values
#define BMI088_SOFTRESET_VAL 0xB6
#define BMI088_ACC_PWR_CONF_SUSPEND_MODE 0x03
#define BMI088_ACC_PWR_CONF_ACTIVE_MODE 0x00
#define BMI088_ACC_OFF 0x00
#define BMI088_ACC_ON 0x04
#define BMI088_GYRO_NORMAL_MODE 0x00
#define BMI088_GYRO_SUSPEND_MODE 0x80
#define BMI088_GYRO_DEEP_SUSPEND_MODE 0x20
#define BMI088_ACCEL_FIFO_MODE 0x01
#define BMI088_ACCEL_STREAM_MODE 0x00
#define BMI088_ACC_ODR_VAL 0x0A // 400hz
#define BMI088_ACC_BWP_NORMAL 0x0A
#define BMI088_ACC_RANGE_VAL 0x03      // 24g
#define BMI088_GYRO_BANDWIDTH_VAL 0x03 // 400 hz
#define BMI088_GYRO_RANGE_VAL 0x02     // +- 500 deg/s
#define BMI088_GYRO_EN_DATA_READY_INT 0x08
#define BMI088_GYRO_EN_FIFO_INT 0x04
#define BMI088_GYRO_INT_PIN_CONFIG_VAL 0x05
#define BMI088_ACC_INT_PIN_CONFIG_VAL 0x0A
#define BMI088_ACC_INT_MAP_PIN_VAL 0x42

#define GYRO_CS_GPIO_PORT GPIOC
#define GYRO_CS_GPIO_PIN GPIO_PIN_6
#define ACCEL_CS_GPIO_PORT GPIOB
#define ACCEL_CS_GPIO_PIN GPIO_PIN_15

#define GPIO_PIN_ACC_INT_VAL GPIO_PIN_13
#define GPIO_PIN_GYRO_INT_VAL GPIO_PIN_14

#define GYRO_SOFTRESET true
#define ACCEL_SOFTRESET true

HAL_StatusTypeDef bmi088Init();
void bmi088ReadAccelerometer(float out[4]);
void bmi088ReadGyroscope(float out[4]);
